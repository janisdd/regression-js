(function(o,l){typeof exports=="object"&&typeof module<"u"?module.exports=l(require("big.js")):typeof define=="function"&&define.amd?define(["big.js"],l):(o=typeof globalThis<"u"?globalThis:o||self,o.regression=l(o.Big))})(this,function(o){"use strict";const l={precision:2,precisionBig:20,predictPoints:!1,bigRoundingMode:1};function m(e,i){const n=10**i;return Math.round(e*n)/n}function g(e,i,n){return e.round(i,o.roundHalfUp)}function b(e,i){const n=[0,0,0,0,0];let s=0;for(let r=0;r<e.length;r++)e[r][1]!==null&&(s++,n[0]+=e[r][0],n[1]+=e[r][1],n[2]+=e[r][0]*e[r][0],n[3]+=e[r][0]*e[r][1],n[4]+=e[r][1]*e[r][1]);const f=s*n[2]-n[0]*n[0],p=s*n[3]-n[0]*n[1],t=f===0?0:m(p/f,i.precision),c=m(n[1]/s-t*n[0]/s,i.precision),d=r=>[m(r,i.precision),m(t*r+c,i.precision)];return{points:i.predictPoints?e.map(r=>d(r[0])):[],predict:d,equation:[t,c],string:c===0?`y = ${t}x`:`y = ${t}x + ${c}`}}function M(e,i){const n=[o(0),o(0),o(0),o(0),o(0)];let s=o(0);for(let u=0;u<e.length;u++)e[u][1]!==null&&(s=s.add(1),n[0]=n[0].add(e[u][0]),n[1]=n[1].add(e[u][1]),n[2]=n[2].add(e[u][0].mul(e[u][0])),n[3]=n[3].add(e[u][0].mul(e[u][1])),n[4]=n[4].add(e[u][1].mul(e[u][1])));const f=s.mul(n[2]).minus(n[0].mul(n[0])),p=s.mul(n[3]).minus(n[0].mul(n[1])),t=o(0),c=f.cmp(t)===0?t:g(p.div(f),i.precision,i.bigRoundingMode),d=g(n[1].div(s).sub(c.mul(n[0]).div(s)),i.precision,i.bigRoundingMode),r=u=>[g(u,i.precision,i.bigRoundingMode),g(c.mul(u).add(d),i.precision,i.bigRoundingMode)];return{points:i.predictPoints?e.map(u=>r(u[0])):[],predict:r,equation:[c,d],string:d.cmp(t)===0?`y = ${c}x`:`y = ${c}x + ${d}`}}return{linear:(e,i)=>b(e,{...l,...i}),linearBig:(e,i)=>M(e,{...l,...i})}});
